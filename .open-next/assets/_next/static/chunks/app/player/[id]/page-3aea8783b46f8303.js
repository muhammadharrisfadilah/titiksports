(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[708],{292:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});var n=t(5155),a=t(2115);function s(e){let{type:r="banner"}=e,t=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(t.current&&!t.current.querySelector("script")){let e=document.createElement("script");e.async=!0,"banner"===r?e.src="//www.highperformanceformat.com/6e5b026d2e2c94efa69ea086137efae4/invoke.js":"medium"===r&&(e.src="//www.highperformanceformat.com/3a0cdf9e77b8522feb634529e3d2d4f0/invoke.js"),t.current.appendChild(e)}},[r]);let s={banner:{key:"6e5b026d2e2c94efa69ea086137efae4",format:"iframe",height:50,width:320},medium:{key:"3a0cdf9e77b8522feb634529e3d2d4f0",format:"iframe",height:250,width:300}},l=s[r]||s.banner;return(0,n.jsx)("div",{className:"ad-banner",children:(0,n.jsx)("div",{ref:t,children:(0,n.jsx)("script",{type:"text/javascript",dangerouslySetInnerHTML:{__html:"\n              atOptions = ".concat(JSON.stringify({...l,params:{}}),";\n            ")}})})})}},1760:(e,r,t)=>{Promise.resolve().then(t.bind(t,292)),Promise.resolve().then(t.bind(t,8850)),Promise.resolve().then(t.t.bind(t,2619,23))},8850:(e,r,t)=>{"use strict";t.d(r,{default:()=>f});var n=t(5155),a=t(2115),s=t(7088);let l="https://streaming-proxy-worker.titikbola.workers.dev";async function c(e,r){if(!window.isSecureContext)return console.warn("⚠️ Unsecure context. Using fallback HMAC implementation."),btoa("".concat(e,":").concat(r)).substring(0,32);let t=new TextEncoder,n=t.encode(r),a=await crypto.subtle.importKey("raw",n,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return Array.from(new Uint8Array(await crypto.subtle.sign("HMAC",a,t.encode(e)))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function o(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"link1";if(!e)return null;if(!l)return console.warn("WORKER_URL not configured, using direct stream URL"),e;try{let e=Date.now().toString(),n="".concat(r,":").concat(t,":").concat(e),a=await c(n,"teskunci123"),s=new URL("".concat(l,"/api/stream/manifest"));return s.searchParams.set("match",r),s.searchParams.set("link",t),s.searchParams.set("ts",e),s.searchParams.set("token",a),console.log("\uD83D\uDD10 Token generated:",{matchId:r,linkId:t,timestamp:new Date(parseInt(e)).toISOString()}),s.toString()}catch(r){return console.error("Error creating secure URL:",r),e}}var i=t(2821),u=t(5889);function d(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,u.QP)((0,i.$)(r))}function m(e){return({auto:"Auto",hd:"HD",sd:"SD",low:"Low"})[e]||"Auto"}function f(e){let{match:r}=e,l=(0,a.useRef)(null),c=(0,a.useRef)(null),i=(0,a.useRef)(null),u=(0,a.useRef)(null),f=(0,a.useRef)(new Set),g=(0,a.useRef)(0),h=(0,a.useRef)(0),p=(0,a.useRef)(!1),v=(0,a.useRef)(0),[b,x]=(0,a.useState)("link1"),[y,k]=(0,a.useState)(!0),[w,j]=(0,a.useState)(null),[D,N]=(0,a.useState)(""),[S,A]=(0,a.useState)(null),[L,R]=(0,a.useState)({buffered:"0s",quality:"Loading...",droppedFrames:0}),[E,T]=(0,a.useState)(!1),M=[{id:"link1",url:r.stream_url1,enabled:!!r.stream_url1},{id:"link2",url:r.stream_url2,enabled:!!r.stream_url2},{id:"link3",url:r.stream_url3,enabled:!!r.stream_url3}].filter(e=>e.enabled),_=(0,a.useCallback)(()=>{if(c.current){try{c.current.destroy()}catch(e){console.warn("HLS cleanup warning:",e.message)}c.current=null}if(i.current){try{i.current.reset()}catch(e){console.warn("DASH cleanup warning:",e.message)}i.current=null}u.current&&(clearInterval(u.current),u.current=null),l.current&&(l.current.removeAttribute("src"),l.current.load())},[]),C=(0,a.useCallback)(()=>{u.current&&clearInterval(u.current),console.log("⏱️ Token refresh timer started (".concat(105," min)")),u.current=setInterval(()=>{console.log("\uD83D\uDD04 Auto token refresh triggered"),H(b,!0)},63e5)},[b]),P=(0,a.useCallback)(()=>{let e=M.findIndex(e=>e.id===b);g.current=0,h.current=0,p.current=!1;for(let r=1;r<=M.length;r++){let t=(e+r)%M.length,n=M[t];if(!f.current.has(n.id)){console.log("\uD83D\uDD04 Switching to alternative: ".concat(n.id)),x(n.id);return}}if(console.warn("⚠️ All links marked as failed, resetting and retrying..."),f.current.clear(),g.current=0,h.current=0,p.current=!1,M.length>0)return void x(M[0].id);console.error("❌ No available links"),j("Semua link gagal. Coba refresh halaman.")},[M,b]),F=async(e,r)=>{let t=l.current;if(t)if(s.Ay.isSupported()){let n=new s.Ay({debug:!1,enableWorker:!0,lowLatencyMode:!1,backBufferLength:60,maxBufferLength:60,maxMaxBufferLength:120,maxBufferSize:4e7,maxBufferHole:.5,manifestLoadingTimeOut:15e3,levelLoadingTimeOut:1e4,fragLoadingTimeOut:1e4,fragLoadingMaxRetry:4,fragLoadingMaxRetryTimeout:8e3,levelLoadingMaxRetry:4,manifestLoadingMaxRetry:4,capLevelToPlayerSize:!0,autoStartLoad:!0,startLevel:-1,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7});n.loadSource(e),n.attachMedia(t),n.on(s.Ay.Events.MANIFEST_PARSED,()=>{console.log("✅ HLS Manifest loaded successfully"),t.play().catch(e=>console.log("Autoplay prevented:",e.message)),k(!1),j(null),g.current=0,h.current=0,p.current=!1,f.current.delete(r),C()}),n.on(s.Ay.Events.ERROR,async(e,a)=>{var l,c,o,i;let u=Date.now();if(u-v.current<3e3)return void console.log("⏳ Error cooldown active, ignoring...");if(v.current=u,console.error("❌ HLS Error:",{type:a.type,details:a.details,fatal:a.fatal,code:null==(l=a.response)?void 0:l.code,url:(null==(c=a.frag)?void 0:c.url)?"[REDACTED]":"N/A"}),(null==(o=a.response)?void 0:o.code)===403){console.warn("\uD83D\uDD12 Token expired (403), refreshing..."),g.current=0,p.current=!0,await H(b,!0);return}if((null==(i=a.response)?void 0:i.code)===503){if(console.warn("\uD83D\uDEAB Server 503 detected"),g.current<2){g.current++,console.log("\uD83D\uDD04 Giving server time to recover... (".concat(g.current,"/2)")),setTimeout(()=>{n&&!p.current&&(console.log("\uD83D\uDD04 Attempting to reload..."),n.startLoad())},3e3*g.current);return}console.warn("⚠️ Server persistently unavailable, switching link"),f.current.add(r),P();return}if(a.details===s.Ay.ErrorDetails.BUFFER_STALLED_ERROR){if(p.current)return void console.log("⏳ Already recovering, ignoring stall...");if(h.current++,console.warn("⏸️ Buffer stall detected (".concat(h.current,"/").concat(5,")")),h.current<5){p.current=!0,setTimeout(()=>{t&&t.paused&&!t.ended&&(console.log("\uD83C\uDFAC Attempting to resume playback..."),t.play().catch(e=>console.log("Resume failed:",e.message))),p.current=!1},2e3);return}return console.error("❌ Buffer stall unrecoverable"),h.current=0,p.current=!1,f.current.add(r),void P()}if(a.details===s.Ay.ErrorDetails.FRAG_LOAD_ERROR){if(p.current)return void console.log("⏳ Already recovering, ignoring frag error...");if(console.warn("\uD83D\uDCE6 Fragment load error"),g.current<5){g.current++,p.current=!0;let e=2e3*g.current;console.log("\uD83D\uDD04 Retrying fragment load ".concat(g.current,"/").concat(5," after ").concat(e,"ms")),setTimeout(()=>{n&&n.startLoad(),setTimeout(()=>{p.current=!1},1e3)},e);return}console.error("❌ Fragment load exhausted retries"),p.current=!1}if(a.fatal)switch(console.error("\uD83D\uDC80 Fatal error detected:",a.type),a.type){case s.Ay.ErrorTypes.NETWORK_ERROR:if(g.current<7){g.current++,p.current=!0;let e=1500*g.current;console.log("\uD83D\uDD04 Network error recovery ".concat(g.current,"/").concat(7)),setTimeout(()=>{n&&n.startLoad(),setTimeout(()=>{p.current=!1},1e3)},e);return}console.error("❌ Network error - all retries exhausted"),f.current.add(r),P();break;case s.Ay.ErrorTypes.MEDIA_ERROR:console.warn("\uD83C\uDFA5 Media error, attempting recovery...");try{n.recoverMediaError(),g.current=0;return}catch(e){console.error("Media recovery failed:",e.message),f.current.add(r),P()}break;default:console.error("❌ Unhandled fatal error"),f.current.add(r),P()}}),n.on(s.Ay.Events.FRAG_LOADED,()=>{g.current>0&&(console.log("✅ Fragment loaded successfully after retry"),g.current=0)}),c.current=n}else if(t.canPlayType("application/vnd.apple.mpegurl")){t.src=e;let n=()=>{console.log("✅ Native HLS loaded"),t.play().catch(e=>console.log("Autoplay prevented:",e.message)),k(!1),j(null),C()},a=()=>{console.error("❌ Native HLS error"),f.current.add(r),P()};return t.addEventListener("loadedmetadata",n),t.addEventListener("error",a),()=>{t.removeEventListener("loadedmetadata",n),t.removeEventListener("error",a)}}else j("Browser tidak mendukung HLS"),k(!1)},I=async(e,r)=>{let n=l.current;if(n)try{let a=await Promise.all([t.e(465),t.e(376)]).then(t.bind(t,4462)),s=a.MediaPlayer().create();s.updateSettings({streaming:{retryAttempts:{MPD:4,XLinkExpansion:2,MediaSegment:4,InitializationSegment:3},retryIntervals:{MPD:1e3,XLinkExpansion:1e3,MediaSegment:1e3,InitializationSegment:1e3},abr:{useDefaultABRRules:!0,ABRStrategy:"abrDynamic"},buffer:{stableBufferTime:40,bufferTimeAtTopQuality:60,bufferTimeAtTopQualityLongForm:90}}}),s.initialize(n,e,!0),s.on(a.MediaPlayer.events.STREAM_INITIALIZED,()=>{console.log("✅ DASH stream initialized"),k(!1),j(null),g.current=0,f.current.delete(r),C()}),s.on(a.MediaPlayer.events.ERROR,e=>{var t;if(console.error("❌ DASH Error:",e.error),(null==(t=e.error)?void 0:t.code)===403){console.warn("\uD83D\uDD12 DASH token expired, refreshing..."),H(b,!0);return}if(g.current<5){g.current++,console.log("\uD83D\uDD04 DASH retry ".concat(g.current,"/").concat(5));return}console.error("❌ DASH exhausted retries"),f.current.add(r),P()}),i.current=s}catch(e){console.error("DASH initialization error:",e.message),f.current.add(r),P()}},H=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];k(!0),j(null),t||(_(),g.current=0,h.current=0,p.current=!1);try{let n=e.slice(-1),a=r["stream_url".concat(n)];if(!a)throw Error("Stream URL tidak tersedia");console.log("\uD83C\uDFAC Initializing player: ".concat(e).concat(t?" (token refresh)":""));let s=await o("".concat("https://streaming-proxy-worker.titikbola.workers.dev","/api/stream/manifest"),r.id,e);a.includes(".mpd")||"link3"===e?await I(s,e):await F(s,e),N("".concat(e.toUpperCase().replace("LINK","Link ")," (").concat(m(e),") Aktif"))}catch(e){console.error("Player initialization error:",e.message),j(e.message||"Gagal memuat stream"),k(!1),t||P()}},O=e=>{e===b||f.current.has(e)||(g.current=0,h.current=0,p.current=!1,x(e))};return(0,a.useEffect)(()=>{let e=e=>{if("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)return;let r=l.current;if(r)switch(e.key){case" ":case"k":e.preventDefault(),r.paused?r.play():r.pause();break;case"f":e.preventDefault(),document.fullscreenElement?document.exitFullscreen():r.requestFullscreen();break;case"m":e.preventDefault(),r.muted=!r.muted;break;case"ArrowLeft":e.preventDefault(),r.currentTime-=5;break;case"ArrowRight":e.preventDefault(),r.currentTime+=5;break;case"ArrowUp":e.preventDefault(),r.volume=Math.min(1,r.volume+.1);break;case"ArrowDown":e.preventDefault(),r.volume=Math.max(0,r.volume-.1);break;case"1":case"2":case"3":e.preventDefault();let t=M.find(r=>r.id==="link".concat(e.key));t&&O(t.id);break;case"s":e.preventDefault(),T(!E)}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[M,b,E]),(0,a.useEffect)(()=>{if(!E)return;let e=setInterval(()=>{var e;let r=l.current;if(!r)return;let t=r.buffered.length>0?"".concat((r.buffered.end(r.buffered.length-1)-r.currentTime).toFixed(1),"s"):"0s",n="Auto";if(c.current&&c.current.levels){let e=c.current.levels[c.current.currentLevel];e&&(n="".concat(e.height,"p"))}R({buffered:t,quality:n,droppedFrames:(null==(e=r.getVideoPlaybackQuality)?void 0:e.call(r).droppedVideoFrames)||0})},1e3);return()=>clearInterval(e)},[E]),(0,a.useEffect)(()=>(M.length>0&&H(b),()=>_()),[b,r.id]),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"relative video-container",children:[(0,n.jsx)("video",{ref:l,controls:!0,autoPlay:!0,playsInline:!0,className:"w-full h-full object-contain bg-black"}),y&&(0,n.jsxs)("div",{className:"overlay",children:[(0,n.jsx)("div",{className:"w-12 h-12 border-4 border-white/30 border-t-netflix-red rounded-full animate-spin"}),(0,n.jsx)("p",{className:"mt-4 text-lg",children:"Memuat streaming..."})]}),w&&(0,n.jsxs)("div",{className:"overlay",children:[(0,n.jsx)("svg",{className:"w-16 h-16 text-yellow-500 mb-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,n.jsx)("h3",{className:"text-xl font-bold mb-2",children:w}),(0,n.jsx)("button",{onClick:()=>{f.current.clear(),g.current=0,h.current=0,H(b)},className:"btn btn-primary mt-4",children:"\uD83D\uDD04 Coba Lagi"})]}),E&&(0,n.jsxs)("div",{className:"absolute top-4 right-4 bg-black/80 backdrop-blur-sm rounded-lg p-4 text-sm space-y-2 z-20",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2 pb-2 border-b border-white/20",children:[(0,n.jsx)("h4",{className:"font-bold",children:"\uD83D\uDCCA Stats"}),(0,n.jsx)("button",{onClick:()=>T(!1),className:"text-gray-400 hover:text-white",children:"✕"})]}),(0,n.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,n.jsx)("span",{className:"text-gray-400",children:"Buffer:"}),(0,n.jsx)("span",{className:"font-mono",children:L.buffered})]}),(0,n.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,n.jsx)("span",{className:"text-gray-400",children:"Quality:"}),(0,n.jsx)("span",{className:"font-mono",children:L.quality})]}),(0,n.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,n.jsx)("span",{className:"text-gray-400",children:"Dropped:"}),(0,n.jsx)("span",{className:"font-mono",children:L.droppedFrames})]}),(0,n.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,n.jsx)("span",{className:"text-gray-400",children:"Retries:"}),(0,n.jsxs)("span",{className:"font-mono",children:[g.current,"/",5]})]})]})]}),M.length>0&&(0,n.jsx)("div",{className:"bg-netflix-darkGray rounded-lg p-4",children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:M.map(e=>(0,n.jsxs)("button",{onClick:()=>O(e.id),disabled:f.current.has(e.id),className:d("px-4 py-2 rounded-lg font-semibold transition-all flex items-center gap-2",b===e.id?"bg-netflix-red text-white shadow-lg":f.current.has(e.id)?"bg-gray-800 text-gray-600 cursor-not-allowed":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:[(0,n.jsx)("span",{className:d("w-2 h-2 rounded-full",b===e.id?"bg-white animate-pulse":"bg-gray-500")}),"Link ",e.id.slice(-1)," (",m(e.id),")"]},e.id))}),(0,n.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,n.jsx)("button",{onClick:()=>T(!E),className:"text-sm text-gray-400 hover:text-white transition-colors",children:E?"\uD83D\uDCCA Hide Stats":"\uD83D\uDCCA Show Stats"}),(0,n.jsx)("div",{className:"text-sm text-gray-400",children:D})]})]})}),(0,n.jsxs)("details",{className:"bg-netflix-darkGray rounded-lg p-4",children:[(0,n.jsx)("summary",{className:"font-semibold cursor-pointer flex items-center gap-2",children:"⌨️ Keyboard Shortcuts"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mt-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("kbd",{className:"kbd",children:"Space"})," Play/Pause"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("kbd",{className:"kbd",children:"F"})," Fullscreen"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("kbd",{className:"kbd",children:"M"})," Mute"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("kbd",{className:"kbd",children:"S"})," Stats"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("kbd",{className:"kbd",children:"←"})," -5s"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("kbd",{className:"kbd",children:"→"})," +5s"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("kbd",{className:"kbd",children:"↑"})," Vol +"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("kbd",{className:"kbd",children:"↓"})," Vol -"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("kbd",{className:"kbd",children:"1/2/3"})," Switch Link"]})]})]})]})}}},e=>{e.O(0,[910,619,909,441,255,358],()=>e(e.s=1760)),_N_E=e.O()}]);